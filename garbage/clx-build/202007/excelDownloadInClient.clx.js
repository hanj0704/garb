/*
 * App URI: 202007/excelDownloadInClient
 * Source Location: 202007/excelDownloadInClient.clx
 *
 * This file was generated by eXbuilder6 compiler, Don't edit manually.
 */
(function(){
	var app = new cpr.core.App("202007/excelDownloadInClient", {
		onPrepare: function(loader){
		},
		onCreate: function(/* cpr.core.AppInstance */ app, exports){
			var linker = {};
			// Start - User Script
			/************************************************
			 * excelDownloadInClient.js
			 * Created at 2020. 7. 21. 오후 3:22:14.
			 *
			 * @author han
			 ************************************************/
			
			/*
			 * "excel download" 버튼(btn1)에서 click 이벤트 발생 시 호출.
			 * 사용자가 컨트롤을 클릭할 때 발생하는 이벤트.
			 */
			function onBtn1Click(/* cpr.events.CMouseEvent */ e){
				/** 
				 * @type cpr.controls.Button
				 */
				var btn1 = e.control;
				var vcGrid = app.lookup("grd1");
				var vcDataSet = app.lookup("ds3");
				
				var vaExportData = vcDataSet.getRowDataRanged();
				console.log(vaExportData);
				exportExcel("sample.xlsx","helloWorld",vaExportData);
				
			}
			
			function s2ab(s) { 
			    var buf = new ArrayBuffer(s.length); //convert s to arrayBuffer
			    var view = new Uint8Array(buf);  //create uint8array as viewer
			    for (var i=0; i<s.length; i++) view[i] = s.charCodeAt(i) & 0xFF; //convert to octet
			    return buf;    
			}
			
			/**
			 * 
			 * @param {String} fileName
			 * @param {String} sheetName
			 * @param {Object[]} excelData
			 */
			function exportExcel(fileName,sheetName,excelData){
				
				var wb = XLSX.utils.book_new();
			
			    // step 2. 시트 만들기 
			    var newWorksheet = XLSX.utils.json_to_sheet(excelData,{dateNF:"YYYY-MM-DD",cellDates : true});
			    
			    // step 3. workbook에 새로만든 워크시트에 이름을 주고 붙인다.  
			    XLSX.utils.book_append_sheet(wb, newWorksheet, sheetName);
			
			    // step 4. 엑셀 파일 만들기 
			    var wbout = XLSX.write(wb, {bookType:'xlsx',  type: 'binary', cellNF:true});
			
			    // step 5. 엑셀 파일 내보내기 
			    saveAs(new Blob([s2ab(wbout)],{type:"application/octet-stream"}),fileName);
			}
			
			/*
			 * "list" 버튼(btn2)에서 click 이벤트 발생 시 호출.
			 * 사용자가 컨트롤을 클릭할 때 발생하는 이벤트.
			 */
			function onBtn2Click(/* cpr.events.CMouseEvent */ e){
				/** 
				 * @type cpr.controls.Button
				 */
				var btn2 = e.control;
				
				app.lookup("sms1").send();
			};
			// End - User Script
			
			// Header
			var dataSet_1 = new cpr.data.DataSet("ds1");
			dataSet_1.parseData({
				"columns": [
					{"name": "column1"},
					{"name": "column2"},
					{"name": "column3"},
					{"name": "column4"},
					{"name": "column5"},
					{"name": "column6"},
					{"name": "column7"},
					{"name": "column8"},
					{"name": "column9"},
					{"name": "column10"}
				],
				"rows": [
					{"column1": "column11", "column2": "column21", "column3": "column31", "column4": "column41", "column5": "column51", "column6": "column61", "column7": "column71", "column8": "column81", "column9": "column91", "column10": "column101"},
					{"column1": "column12", "column2": "column22", "column3": "column32", "column4": "column42", "column5": "column52", "column6": "column62", "column7": "column72", "column8": "column82", "column9": "column92", "column10": "column102"},
					{"column1": "column13", "column2": "column23", "column3": "column33", "column4": "column43", "column5": "column53", "column6": "column63", "column7": "column73", "column8": "column83", "column9": "column93", "column10": "column103"},
					{"column1": "column14", "column2": "column24", "column3": "column34", "column4": "column44", "column5": "column54", "column6": "column64", "column7": "column74", "column8": "column84", "column9": "column94", "column10": "column104"},
					{"column1": "column15", "column2": "column25", "column3": "column35", "column4": "column45", "column5": "column55", "column6": "column65", "column7": "column75", "column8": "column85", "column9": "column95", "column10": "column105"},
					{"column1": "column16", "column2": "column26", "column3": "column36", "column4": "column46", "column5": "column56", "column6": "column66", "column7": "column76", "column8": "column86", "column9": "column96", "column10": "column106"},
					{"column1": "column17", "column2": "column27", "column3": "column37", "column4": "column47", "column5": "column57", "column6": "column67", "column7": "column77", "column8": "column87", "column9": "column97", "column10": "column107"},
					{"column1": "column18", "column2": "column28", "column3": "column38", "column4": "column48", "column5": "column58", "column6": "column68", "column7": "column78", "column8": "column88", "column9": "column98", "column10": "column108"},
					{"column1": "column19", "column2": "column29", "column3": "column39", "column4": "column49", "column5": "column59", "column6": "column69", "column7": "column79", "column8": "column89", "column9": "column99", "column10": "column109"},
					{"column1": "column110", "column2": "column210", "column3": "column310", "column4": "column410", "column5": "column510", "column6": "column610", "column7": "column710", "column8": "column810", "column9": "column910", "column10": "column1010"},
					{"column1": "column111", "column2": "column211", "column3": "column311", "column4": "column411", "column5": "column511", "column6": "column611", "column7": "column711", "column8": "column811", "column9": "column911", "column10": "column1011"},
					{"column1": "column112", "column2": "column212", "column3": "column312", "column4": "column412", "column5": "column512", "column6": "column612", "column7": "column712", "column8": "column812", "column9": "column912", "column10": "column1012"},
					{"column1": "column113", "column2": "column213", "column3": "column313", "column4": "column413", "column5": "column513", "column6": "column613", "column7": "column713", "column8": "column813", "column9": "column913", "column10": "column1013"},
					{"column1": "column114", "column2": "column214", "column3": "column314", "column4": "column414", "column5": "column514", "column6": "column614", "column7": "column714", "column8": "column814", "column9": "column914", "column10": "column1014"},
					{"column1": "column115", "column2": "column215", "column3": "column315", "column4": "column415", "column5": "column515", "column6": "column615", "column7": "column715", "column8": "column815", "column9": "column915", "column10": "column1015"},
					{"column1": "column116", "column2": "column216", "column3": "column316", "column4": "column416", "column5": "column516", "column6": "column616", "column7": "column716", "column8": "column816", "column9": "column916", "column10": "column1016"},
					{"column1": "column117", "column2": "column217", "column3": "column317", "column4": "column417", "column5": "column517", "column6": "column617", "column7": "column717", "column8": "column817", "column9": "column917", "column10": "column1017"},
					{"column1": "column118", "column2": "column218", "column3": "column318", "column4": "column418", "column5": "column518", "column6": "column618", "column7": "column718", "column8": "column818", "column9": "column918", "column10": "column1018"},
					{"column1": "column119", "column2": "column219", "column3": "column319", "column4": "column419", "column5": "column519", "column6": "column619", "column7": "column719", "column8": "column819", "column9": "column919", "column10": "column1019"},
					{"column1": "column120", "column2": "column220", "column3": "column320", "column4": "column420", "column5": "column520", "column6": "column620", "column7": "column720", "column8": "column820", "column9": "column920", "column10": "column1020"},
					{"column1": "column121", "column2": "column221", "column3": "column321", "column4": "column421", "column5": "column521", "column6": "column621", "column7": "column721", "column8": "column821", "column9": "column921", "column10": "column1021"},
					{"column1": "column122", "column2": "column222", "column3": "column322", "column4": "column422", "column5": "column522", "column6": "column622", "column7": "column722", "column8": "column822", "column9": "column922", "column10": "column1022"},
					{"column1": "column123", "column2": "column223", "column3": "column323", "column4": "column423", "column5": "column523", "column6": "column623", "column7": "column723", "column8": "column823", "column9": "column923", "column10": "column1023"},
					{"column1": "column124", "column2": "column224", "column3": "column324", "column4": "column424", "column5": "column524", "column6": "column624", "column7": "column724", "column8": "column824", "column9": "column924", "column10": "column1024"},
					{"column1": "column125", "column2": "column225", "column3": "column325", "column4": "column425", "column5": "column525", "column6": "column625", "column7": "column725", "column8": "column825", "column9": "column925", "column10": "column1025"},
					{"column1": "column126", "column2": "column226", "column3": "column326", "column4": "column426", "column5": "column526", "column6": "column626", "column7": "column726", "column8": "column826", "column9": "column926", "column10": "column1026"},
					{"column1": "column127", "column2": "column227", "column3": "column327", "column4": "column427", "column5": "column527", "column6": "column627", "column7": "column727", "column8": "column827", "column9": "column927", "column10": "column1027"},
					{"column1": "column128", "column2": "column228", "column3": "column328", "column4": "column428", "column5": "column528", "column6": "column628", "column7": "column728", "column8": "column828", "column9": "column928", "column10": "column1028"},
					{"column1": "column129", "column2": "column229", "column3": "column329", "column4": "column429", "column5": "column529", "column6": "column629", "column7": "column729", "column8": "column829", "column9": "column929", "column10": "column1029"},
					{"column1": "column130", "column2": "column230", "column3": "column330", "column4": "column430", "column5": "column530", "column6": "column630", "column7": "column730", "column8": "column830", "column9": "column930", "column10": "column1030"},
					{"column1": "column131", "column2": "column231", "column3": "column331", "column4": "column431", "column5": "column531", "column6": "column631", "column7": "column731", "column8": "column831", "column9": "column931", "column10": "column1031"},
					{"column1": "column132", "column2": "column232", "column3": "column332", "column4": "column432", "column5": "column532", "column6": "column632", "column7": "column732", "column8": "column832", "column9": "column932", "column10": "column1032"},
					{"column1": "column133", "column2": "column233", "column3": "column333", "column4": "column433", "column5": "column533", "column6": "column633", "column7": "column733", "column8": "column833", "column9": "column933", "column10": "column1033"},
					{"column1": "column134", "column2": "column234", "column3": "column334", "column4": "column434", "column5": "column534", "column6": "column634", "column7": "column734", "column8": "column834", "column9": "column934", "column10": "column1034"},
					{"column1": "column135", "column2": "column235", "column3": "column335", "column4": "column435", "column5": "column535", "column6": "column635", "column7": "column735", "column8": "column835", "column9": "column935", "column10": "column1035"},
					{"column1": "column136", "column2": "column236", "column3": "column336", "column4": "column436", "column5": "column536", "column6": "column636", "column7": "column736", "column8": "column836", "column9": "column936", "column10": "column1036"},
					{"column1": "column137", "column2": "column237", "column3": "column337", "column4": "column437", "column5": "column537", "column6": "column637", "column7": "column737", "column8": "column837", "column9": "column937", "column10": "column1037"},
					{"column1": "column138", "column2": "column238", "column3": "column338", "column4": "column438", "column5": "column538", "column6": "column638", "column7": "column738", "column8": "column838", "column9": "column938", "column10": "column1038"},
					{"column1": "column139", "column2": "column239", "column3": "column339", "column4": "column439", "column5": "column539", "column6": "column639", "column7": "column739", "column8": "column839", "column9": "column939", "column10": "column1039"},
					{"column1": "column140", "column2": "column240", "column3": "column340", "column4": "column440", "column5": "column540", "column6": "column640", "column7": "column740", "column8": "column840", "column9": "column940", "column10": "column1040"},
					{"column1": "column141", "column2": "column241", "column3": "column341", "column4": "column441", "column5": "column541", "column6": "column641", "column7": "column741", "column8": "column841", "column9": "column941", "column10": "column1041"},
					{"column1": "column142", "column2": "column242", "column3": "column342", "column4": "column442", "column5": "column542", "column6": "column642", "column7": "column742", "column8": "column842", "column9": "column942", "column10": "column1042"},
					{"column1": "column143", "column2": "column243", "column3": "column343", "column4": "column443", "column5": "column543", "column6": "column643", "column7": "column743", "column8": "column843", "column9": "column943", "column10": "column1043"},
					{"column1": "column144", "column2": "column244", "column3": "column344", "column4": "column444", "column5": "column544", "column6": "column644", "column7": "column744", "column8": "column844", "column9": "column944", "column10": "column1044"},
					{"column1": "column145", "column2": "column245", "column3": "column345", "column4": "column445", "column5": "column545", "column6": "column645", "column7": "column745", "column8": "column845", "column9": "column945", "column10": "column1045"},
					{"column1": "column146", "column2": "column246", "column3": "column346", "column4": "column446", "column5": "column546", "column6": "column646", "column7": "column746", "column8": "column846", "column9": "column946", "column10": "column1046"},
					{"column1": "column147", "column2": "column247", "column3": "column347", "column4": "column447", "column5": "column547", "column6": "column647", "column7": "column747", "column8": "column847", "column9": "column947", "column10": "column1047"},
					{"column1": "column148", "column2": "column248", "column3": "column348", "column4": "column448", "column5": "column548", "column6": "column648", "column7": "column748", "column8": "column848", "column9": "column948", "column10": "column1048"},
					{"column1": "column149", "column2": "column249", "column3": "column349", "column4": "column449", "column5": "column549", "column6": "column649", "column7": "column749", "column8": "column849", "column9": "column949", "column10": "column1049"},
					{"column1": "column150", "column2": "column250", "column3": "column350", "column4": "column450", "column5": "column550", "column6": "column650", "column7": "column750", "column8": "column850", "column9": "column950", "column10": "column1050"},
					{"column1": "column151", "column2": "column251", "column3": "column351", "column4": "column451", "column5": "column551", "column6": "column651", "column7": "column751", "column8": "column851", "column9": "column951", "column10": "column1051"},
					{"column1": "column152", "column2": "column252", "column3": "column352", "column4": "column452", "column5": "column552", "column6": "column652", "column7": "column752", "column8": "column852", "column9": "column952", "column10": "column1052"},
					{"column1": "column153", "column2": "column253", "column3": "column353", "column4": "column453", "column5": "column553", "column6": "column653", "column7": "column753", "column8": "column853", "column9": "column953", "column10": "column1053"},
					{"column1": "column154", "column2": "column254", "column3": "column354", "column4": "column454", "column5": "column554", "column6": "column654", "column7": "column754", "column8": "column854", "column9": "column954", "column10": "column1054"},
					{"column1": "column155", "column2": "column255", "column3": "column355", "column4": "column455", "column5": "column555", "column6": "column655", "column7": "column755", "column8": "column855", "column9": "column955", "column10": "column1055"},
					{"column1": "column156", "column2": "column256", "column3": "column356", "column4": "column456", "column5": "column556", "column6": "column656", "column7": "column756", "column8": "column856", "column9": "column956", "column10": "column1056"},
					{"column1": "column157", "column2": "column257", "column3": "column357", "column4": "column457", "column5": "column557", "column6": "column657", "column7": "column757", "column8": "column857", "column9": "column957", "column10": "column1057"},
					{"column1": "column158", "column2": "column258", "column3": "column358", "column4": "column458", "column5": "column558", "column6": "column658", "column7": "column758", "column8": "column858", "column9": "column958", "column10": "column1058"},
					{"column1": "column159", "column2": "column259", "column3": "column359", "column4": "column459", "column5": "column559", "column6": "column659", "column7": "column759", "column8": "column859", "column9": "column959", "column10": "column1059"},
					{"column1": "column160", "column2": "column260", "column3": "column360", "column4": "column460", "column5": "column560", "column6": "column660", "column7": "column760", "column8": "column860", "column9": "column960", "column10": "column1060"},
					{"column1": "column161", "column2": "column261", "column3": "column361", "column4": "column461", "column5": "column561", "column6": "column661", "column7": "column761", "column8": "column861", "column9": "column961", "column10": "column1061"},
					{"column1": "column162", "column2": "column262", "column3": "column362", "column4": "column462", "column5": "column562", "column6": "column662", "column7": "column762", "column8": "column862", "column9": "column962", "column10": "column1062"},
					{"column1": "column163", "column2": "column263", "column3": "column363", "column4": "column463", "column5": "column563", "column6": "column663", "column7": "column763", "column8": "column863", "column9": "column963", "column10": "column1063"},
					{"column1": "column164", "column2": "column264", "column3": "column364", "column4": "column464", "column5": "column564", "column6": "column664", "column7": "column764", "column8": "column864", "column9": "column964", "column10": "column1064"},
					{"column1": "column165", "column2": "column265", "column3": "column365", "column4": "column465", "column5": "column565", "column6": "column665", "column7": "column765", "column8": "column865", "column9": "column965", "column10": "column1065"},
					{"column1": "column166", "column2": "column266", "column3": "column366", "column4": "column466", "column5": "column566", "column6": "column666", "column7": "column766", "column8": "column866", "column9": "column966", "column10": "column1066"},
					{"column1": "column167", "column2": "column267", "column3": "column367", "column4": "column467", "column5": "column567", "column6": "column667", "column7": "column767", "column8": "column867", "column9": "column967", "column10": "column1067"},
					{"column1": "column168", "column2": "column268", "column3": "column368", "column4": "column468", "column5": "column568", "column6": "column668", "column7": "column768", "column8": "column868", "column9": "column968", "column10": "column1068"},
					{"column1": "column169", "column2": "column269", "column3": "column369", "column4": "column469", "column5": "column569", "column6": "column669", "column7": "column769", "column8": "column869", "column9": "column969", "column10": "column1069"},
					{"column1": "column170", "column2": "column270", "column3": "column370", "column4": "column470", "column5": "column570", "column6": "column670", "column7": "column770", "column8": "column870", "column9": "column970", "column10": "column1070"},
					{"column1": "column171", "column2": "column271", "column3": "column371", "column4": "column471", "column5": "column571", "column6": "column671", "column7": "column771", "column8": "column871", "column9": "column971", "column10": "column1071"},
					{"column1": "column172", "column2": "column272", "column3": "column372", "column4": "column472", "column5": "column572", "column6": "column672", "column7": "column772", "column8": "column872", "column9": "column972", "column10": "column1072"},
					{"column1": "column173", "column2": "column273", "column3": "column373", "column4": "column473", "column5": "column573", "column6": "column673", "column7": "column773", "column8": "column873", "column9": "column973", "column10": "column1073"},
					{"column1": "column174", "column2": "column274", "column3": "column374", "column4": "column474", "column5": "column574", "column6": "column674", "column7": "column774", "column8": "column874", "column9": "column974", "column10": "column1074"},
					{"column1": "column175", "column2": "column275", "column3": "column375", "column4": "column475", "column5": "column575", "column6": "column675", "column7": "column775", "column8": "column875", "column9": "column975", "column10": "column1075"},
					{"column1": "column176", "column2": "column276", "column3": "column376", "column4": "column476", "column5": "column576", "column6": "column676", "column7": "column776", "column8": "column876", "column9": "column976", "column10": "column1076"},
					{"column1": "column177", "column2": "column277", "column3": "column377", "column4": "column477", "column5": "column577", "column6": "column677", "column7": "column777", "column8": "column877", "column9": "column977", "column10": "column1077"},
					{"column1": "column178", "column2": "column278", "column3": "column378", "column4": "column478", "column5": "column578", "column6": "column678", "column7": "column778", "column8": "column878", "column9": "column978", "column10": "column1078"},
					{"column1": "column179", "column2": "column279", "column3": "column379", "column4": "column479", "column5": "column579", "column6": "column679", "column7": "column779", "column8": "column879", "column9": "column979", "column10": "column1079"},
					{"column1": "column180", "column2": "column280", "column3": "column380", "column4": "column480", "column5": "column580", "column6": "column680", "column7": "column780", "column8": "column880", "column9": "column980", "column10": "column1080"},
					{"column1": "column181", "column2": "column281", "column3": "column381", "column4": "column481", "column5": "column581", "column6": "column681", "column7": "column781", "column8": "column881", "column9": "column981", "column10": "column1081"},
					{"column1": "column182", "column2": "column282", "column3": "column382", "column4": "column482", "column5": "column582", "column6": "column682", "column7": "column782", "column8": "column882", "column9": "column982", "column10": "column1082"},
					{"column1": "column183", "column2": "column283", "column3": "column383", "column4": "column483", "column5": "column583", "column6": "column683", "column7": "column783", "column8": "column883", "column9": "column983", "column10": "column1083"},
					{"column1": "column184", "column2": "column284", "column3": "column384", "column4": "column484", "column5": "column584", "column6": "column684", "column7": "column784", "column8": "column884", "column9": "column984", "column10": "column1084"},
					{"column1": "column185", "column2": "column285", "column3": "column385", "column4": "column485", "column5": "column585", "column6": "column685", "column7": "column785", "column8": "column885", "column9": "column985", "column10": "column1085"},
					{"column1": "column186", "column2": "column286", "column3": "column386", "column4": "column486", "column5": "column586", "column6": "column686", "column7": "column786", "column8": "column886", "column9": "column986", "column10": "column1086"},
					{"column1": "column187", "column2": "column287", "column3": "column387", "column4": "column487", "column5": "column587", "column6": "column687", "column7": "column787", "column8": "column887", "column9": "column987", "column10": "column1087"},
					{"column1": "column188", "column2": "column288", "column3": "column388", "column4": "column488", "column5": "column588", "column6": "column688", "column7": "column788", "column8": "column888", "column9": "column988", "column10": "column1088"},
					{"column1": "column189", "column2": "column289", "column3": "column389", "column4": "column489", "column5": "column589", "column6": "column689", "column7": "column789", "column8": "column889", "column9": "column989", "column10": "column1089"},
					{"column1": "column190", "column2": "column290", "column3": "column390", "column4": "column490", "column5": "column590", "column6": "column690", "column7": "column790", "column8": "column890", "column9": "column990", "column10": "column1090"},
					{"column1": "column191", "column2": "column291", "column3": "column391", "column4": "column491", "column5": "column591", "column6": "column691", "column7": "column791", "column8": "column891", "column9": "column991", "column10": "column1091"},
					{"column1": "column192", "column2": "column292", "column3": "column392", "column4": "column492", "column5": "column592", "column6": "column692", "column7": "column792", "column8": "column892", "column9": "column992", "column10": "column1092"},
					{"column1": "column193", "column2": "column293", "column3": "column393", "column4": "column493", "column5": "column593", "column6": "column693", "column7": "column793", "column8": "column893", "column9": "column993", "column10": "column1093"},
					{"column1": "column194", "column2": "column294", "column3": "column394", "column4": "column494", "column5": "column594", "column6": "column694", "column7": "column794", "column8": "column894", "column9": "column994", "column10": "column1094"},
					{"column1": "column195", "column2": "column295", "column3": "column395", "column4": "column495", "column5": "column595", "column6": "column695", "column7": "column795", "column8": "column895", "column9": "column995", "column10": "column1095"},
					{"column1": "column196", "column2": "column296", "column3": "column396", "column4": "column496", "column5": "column596", "column6": "column696", "column7": "column796", "column8": "column896", "column9": "column996", "column10": "column1096"},
					{"column1": "column197", "column2": "column297", "column3": "column397", "column4": "column497", "column5": "column597", "column6": "column697", "column7": "column797", "column8": "column897", "column9": "column997", "column10": "column1097"},
					{"column1": "column198", "column2": "column298", "column3": "column398", "column4": "column498", "column5": "column598", "column6": "column698", "column7": "column798", "column8": "column898", "column9": "column998", "column10": "column1098"},
					{"column1": "column199", "column2": "column299", "column3": "column399", "column4": "column499", "column5": "column599", "column6": "column699", "column7": "column799", "column8": "column899", "column9": "column999", "column10": "column1099"},
					{"column1": "column1100", "column2": "column2100", "column3": "column3100", "column4": "column4100", "column5": "column5100", "column6": "column6100", "column7": "column7100", "column8": "column8100", "column9": "column9100", "column10": "column10100"}
				]
			});
			app.register(dataSet_1);
			
			var dataSet_2 = new cpr.data.DataSet("ds2");
			dataSet_2.parseData({
				"columns" : [
					{"name": "column1"},
					{"name": "column2"},
					{"name": "column3"},
					{"name": "column4"},
					{"name": "column5"},
					{"name": "column6"},
					{"name": "column7"},
					{"name": "column8"},
					{"name": "column9"},
					{"name": "column10"},
					{"name": "column11"},
					{"name": "column12"},
					{"name": "column13"},
					{"name": "column14"},
					{"name": "column15"},
					{"name": "column16"},
					{"name": "column17"},
					{"name": "column18"},
					{"name": "column19"},
					{"name": "column20"}
				]
			});
			app.register(dataSet_2);
			
			var dataSet_3 = new cpr.data.DataSet("ds3");
			dataSet_3.parseData({
				"columns": [
					{
						"name": "number1",
						"dataType": "number"
					},
					{
						"name": "num2",
						"dataType": "number"
					},
					{"name": "string1"},
					{"name": "date1"}
				],
				"rows": [
					{"number1": "123123123", "num2": "1", "string1": "string11", "date1": "20200724"},
					{"number1": "234234", "num2": "2", "string1": "string12", "date1": "20200724"},
					{"number1": "2624624", "num2": "3", "string1": "string13", "date1": "20200724"},
					{"number1": "1512546", "num2": "4", "string1": "string14", "date1": "20200724"},
					{"number1": "142154576", "num2": "5", "string1": "string15", "date1": "20200724"},
					{"number1": "4545", "num2": "6", "string1": "string16", "date1": "20200724"},
					{"number1": "131677", "num2": "7", "string1": "string17", "date1": "20200724"}
				]
			});
			app.register(dataSet_3);
			var submission_1 = new cpr.protocols.Submission("sms1");
			submission_1.action = "/cisweb/getListHana.do";
			submission_1.addResponseData(dataSet_2, false);
			if(typeof onSms1SubmitDone == "function") {
				submission_1.addEventListener("submit-done", onSms1SubmitDone);
			}
			app.register(submission_1);
			
			var submission_2 = new cpr.protocols.Submission("subExport");
			submission_2.action = "/export/gridExport.xlsx";
			submission_2.mediaType = "application/x-www-form-urlencoded";
			submission_2.responseType = "filedownload";
			app.register(submission_2);
			
			var submission_3 = new cpr.protocols.Submission("subExcel");
			submission_3.action = "/export/exportExcel.xlsx";
			submission_3.mediaType = "application/x-www-form-urlencoded";
			submission_3.responseType = "filedownload";
			app.register(submission_3);
			
			app.supportMedia("all and (min-width: 1024px)", "default");
			app.supportMedia("all and (min-width: 500px) and (max-width: 1023px)", "tablet");
			app.supportMedia("all and (max-width: 499px)", "mobile");
			
			// Configure root container
			var container = app.getContainer();
			container.style.css({
				"width" : "100%",
				"top" : "0px",
				"height" : "100%",
				"left" : "0px"
			});
			
			// Layout
			var xYLayout_1 = new cpr.controls.layouts.XYLayout();
			container.setLayout(xYLayout_1);
			
			// UI Configuration
			var button_1 = new cpr.controls.Button("btn1");
			button_1.value = "excel download";
			if(typeof onBtn1Click == "function") {
				button_1.addEventListener("click", onBtn1Click);
			}
			container.addChild(button_1, {
				"top": "20px",
				"right": "160px",
				"width": "122px",
				"height": "20px"
			});
			
			var grid_1 = new cpr.controls.Grid("grd1");
			grid_1.init({
				"dataSet": app.lookup("ds3"),
				"showDeletedRow": false,
				"columns": [
					{"width": "100px"},
					{"width": "100px"},
					{"width": "100px"},
					{"width": "100px"}
				],
				"header": {
					"rows": [{"height": "24px"}],
					"cells": [
						{
							"constraint": {"rowIndex": 0, "colIndex": 0},
							"configurator": function(cell){
								cell.targetColumnName = "number1";
								cell.filterable = false;
								cell.sortable = false;
								cell.text = "number1";
							}
						},
						{
							"constraint": {"rowIndex": 0, "colIndex": 1},
							"configurator": function(cell){
								cell.targetColumnName = "num2";
								cell.filterable = false;
								cell.sortable = false;
								cell.text = "num2";
							}
						},
						{
							"constraint": {"rowIndex": 0, "colIndex": 2},
							"configurator": function(cell){
								cell.targetColumnName = "string1";
								cell.filterable = false;
								cell.sortable = false;
								cell.text = "string1";
							}
						},
						{
							"constraint": {"rowIndex": 0, "colIndex": 3},
							"configurator": function(cell){
								cell.targetColumnName = "date1";
								cell.filterable = false;
								cell.sortable = false;
								cell.text = "date1";
							}
						}
					]
				},
				"detail": {
					"rows": [{"height": "24px"}],
					"cells": [
						{
							"constraint": {"rowIndex": 0, "colIndex": 0},
							"configurator": function(cell){
								cell.columnName = "number1";
								cell.control = (function(){
									var numberEditor_1 = new cpr.controls.NumberEditor("nbe1");
									numberEditor_1.bind("value").toDataColumn("number1");
									return numberEditor_1;
								})();
							}
						},
						{
							"constraint": {"rowIndex": 0, "colIndex": 1},
							"configurator": function(cell){
								cell.columnName = "num2";
								cell.control = (function(){
									var numberEditor_2 = new cpr.controls.NumberEditor("nbe2");
									numberEditor_2.bind("value").toDataColumn("num2");
									return numberEditor_2;
								})();
							}
						},
						{
							"constraint": {"rowIndex": 0, "colIndex": 2},
							"configurator": function(cell){
								cell.columnName = "string1";
								cell.control = (function(){
									var inputBox_1 = new cpr.controls.InputBox("ipb1");
									inputBox_1.bind("value").toDataColumn("string1");
									return inputBox_1;
								})();
							}
						},
						{
							"constraint": {"rowIndex": 0, "colIndex": 3},
							"configurator": function(cell){
								cell.columnName = "date1";
								cell.control = (function(){
									var dateInput_1 = new cpr.controls.DateInput("dti1");
									dateInput_1.bind("value").toDataColumn("date1");
									return dateInput_1;
								})();
							}
						}
					]
				}
			});
			container.addChild(grid_1, {
				"top": "50px",
				"right": "20px",
				"left": "20px",
				"height": "376px"
			});
			
			var button_2 = new cpr.controls.Button("btn2");
			button_2.value = "list";
			if(typeof onBtn2Click == "function") {
				button_2.addEventListener("click", onBtn2Click);
			}
			container.addChild(button_2, {
				"top": "20px",
				"left": "632px",
				"width": "100px",
				"height": "20px"
			});
			
			var button_3 = new cpr.controls.Button("btn3");
			button_3.value = "excel server";
			if(typeof onBtn3Click == "function") {
				button_3.addEventListener("click", onBtn3Click);
			}
			container.addChild(button_3, {
				"top": "20px",
				"right": "28px",
				"width": "122px",
				"height": "20px"
			});
		}
	});
	app.title = "excelDownloadInClient";
	cpr.core.Platform.INSTANCE.register(app);
})();
